<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Phone Store - Choose Your Brand</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #ef4444; 
            --primary-hover: #dc2626;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: white;
            transition: background-color 0.3s ease;
            overflow-x: hidden;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        .theme-bg { background-color: var(--primary-color) !important; }
        .theme-text { color: var(--primary-color) !important; }
        .theme-border { border-color: var(--primary-color) !important; }

        /* Styles for Brand Carousel */
        #brand-slider-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 380px;
            position: relative;
            width: 100vw;
            perspective: 1200px;
            cursor: grab;
        }

        .brand-card {
            position: absolute;
            transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
            width: 200px;
            height: 280px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 2rem;
            box-shadow: 0 10px 30px -5px rgba(0,0,0,0.08);
            pointer-events: auto;
            overflow: hidden;
            padding: 15px;
            border: 1px solid #f1f5f9;
        }

        @media (min-width: 768px) {
            .brand-card { width: 260px; height: 340px; }
            #brand-slider-container { height: 450px; }
        }

        .brand-logo-img {
            width: 80px;
            height: 80px;
            object-fit: contain;
        }

        .brand-card.active {
            transform: translate3d(0, 0, 150px) scale(1.1);
            opacity: 1;
            z-index: 30;
            box-shadow: 0 25px 60px -12px rgba(0,0,0,0.15);
            border: none;
        }

        .brand-card.prev { transform: translate3d(-100%, 0, 0) scale(0.7) rotateY(20deg); opacity: 0.3; z-index: 20; }
        .brand-card.next { transform: translate3d(100%, 0, 0) scale(0.7) rotateY(-20deg); opacity: 0.3; z-index: 20; }
        .brand-card.hidden-left { transform: translate3d(-200%, 0, -100px) scale(0.5); opacity: 0; }
        .brand-card.hidden-right { transform: translate3d(200%, 0, -100px) scale(0.5); opacity: 0; }

        .phone-display-img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            transition: opacity 0.4s ease, transform 0.4s ease;
        }

        .modal-blur {
            backdrop-filter: blur(25px);
            background: rgba(255, 255, 255, 0.95);
        }

        /* Delivery Animations */
        @keyframes drawPath { 0% { stroke-dashoffset: 1200; } 100% { stroke-dashoffset: 0; } }
        .path-line { stroke-dasharray: 1200; stroke-dashoffset: 1200; }
        .animate-path { animation: drawPath 4s ease-in-out forwards; }

        .van-on-path {
            offset-path: path("M50 350 L200 350 L200 150 L500 150 L500 300 L750 300");
            offset-rotate: auto;
            animation: moveVan 4s ease-in-out forwards;
            position: absolute;
        }

        @keyframes moveVan { 0% { offset-distance: 0%; } 100% { offset-distance: 100%; } }
        .dest-pulse { animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { transform: scale(1); opacity: 0.5; } 100% { transform: scale(1.5); opacity: 0; } }

        #settings-menu { transform: translateX(100%); transition: transform 0.4s ease; }
        #settings-menu.open { transform: translateX(0); }

        .storage-btn.active {
            background-color: var(--primary-color) !important;
            color: white !important;
            border-color: var(--primary-color) !important;
        }

        /* Modal Mobile Optimization */
        @media (max-width: 767px) {
            #order-modal > div {
                height: 100%;
                width: 100%;
                max-width: none;
                max-height: none;
                border-radius: 0;
                border: none;
            }
            #modal-image-container img {
                max-height: 180px;
                width: auto;
            }
        }
    </style>
</head>
<body>

    <header id="main-header" class="theme-bg text-white py-4 md:py-6 text-center fixed top-0 w-full z-50 shadow-md">
        <h1 id="header-title" class="text-lg md:text-xl font-black uppercase tracking-tighter">Choose Brand</h1>
    </header>

    <main class="mt-16 md:mt-20">
        <!-- STEP 1: BRAND SELECTION -->
        <section id="brand-selection" class="min-h-[90vh] flex flex-col justify-center items-center overflow-hidden bg-white">
            <div id="brand-slider-container"></div>
            <div class="flex items-center gap-8 md:gap-12 mt-4">
                <button onclick="moveBrand(-1)" class="p-3 md:p-4 rounded-full bg-white border border-slate-100 shadow-sm transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M15 19l-7-7 7-7" /></svg>
                </button>
                <div class="text-[9px] font-black text-slate-300 uppercase tracking-widest">Swipe or click</div>
                <button onclick="moveBrand(1)" class="p-3 md:p-4 rounded-full bg-white border border-slate-100 shadow-sm transition">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 5l7 7-7 7" /></svg>
                </button>
            </div>
        </section>

        <!-- STEP 2: PHONE CATALOG -->
        <section id="phone-catalog" class="hidden px-4 md:px-6 pt-6 md:pt-10 pb-24">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 md:gap-8 max-w-[1600px] mx-auto"></div>
        </section>

        <!-- STEP 3: SUCCESS SCREEN -->
        <section id="order-success" class="hidden flex flex-col items-center justify-start md:justify-center min-h-screen px-4 pt-10 md:pt-20">
            <div class="max-w-4xl w-full">
                <div class="text-center mb-6">
                    <h2 class="text-3xl md:text-6xl font-black theme-text uppercase italic tracking-tighter mb-2">On the Way!</h2>
                    <p class="text-slate-400 font-bold uppercase tracking-widest text-[9px]">12 - 24 Hours Delivery</p>
                </div>
                
                <div class="flex justify-between mb-6 px-4">
                    <div class="flex flex-col items-center"><div class="w-8 h-8 rounded-full theme-bg text-white flex items-center justify-center font-bold text-xs">‚úì</div></div>
                    <div class="flex-1 h-[2px] bg-slate-100 mt-4 mx-2"><div class="h-full theme-bg w-full"></div></div>
                    <div class="flex flex-col items-center"><div class="w-8 h-8 rounded-full theme-bg text-white flex items-center justify-center font-bold text-xs animate-pulse">üöö</div></div>
                    <div class="flex-1 h-[2px] bg-slate-100 mt-4 mx-2"></div>
                    <div class="flex flex-col items-center"><div class="w-8 h-8 rounded-full bg-slate-100 text-slate-300 flex items-center justify-center font-bold text-xs">üè†</div></div>
                </div>

                <div class="w-full aspect-video md:aspect-[21/9] bg-white rounded-[1.5rem] relative overflow-hidden shadow-xl border-2 theme-border">
                    <svg viewBox="0 0 800 450" class="w-full h-full bg-[#f8fafc]" preserveAspectRatio="xMidYMid slice">
                        <path d="M0 50 L800 50 M0 250 L800 250 M400 0 L400 450 M100 0 L100 450" stroke="#f1f5f9" stroke-width="40" fill="none" />
                        <path id="delivery-path" class="path-line" d="M50 350 L200 350 L200 150 L500 150 L500 300 L750 300" fill="none" stroke="var(--primary-color)" stroke-width="14" stroke-linecap="round" stroke-linejoin="round" />
                        <text x="35" y="370" font-size="30">üè™</text>
                        <text x="735" y="320" font-size="30">üè†</text>
                        <g id="courier-van" class="van-on-path"><text x="-15" y="-5" font-size="30">üöö</text></g>
                    </svg>
                </div>

                <button onclick="resetApp()" class="mt-8 w-full theme-bg text-white py-4 rounded-xl font-black uppercase tracking-widest shadow-lg">Back to Store</button>
            </div>
        </section>
    </main>

    <!-- MODAL (FULLY REWORKED FOR MOBILE) -->
    <div id="order-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center">
        <div class="absolute inset-0 modal-blur md:block hidden" onclick="closeModal()"></div>
        <div class="bg-white w-full max-w-5xl md:rounded-[4rem] shadow-2xl relative z-10 overflow-hidden flex flex-col md:flex-row border-4 theme-border max-h-screen md:max-h-[90vh]">
            
            <!-- Close for Mobile -->
            <button onclick="closeModal()" class="md:hidden absolute top-4 right-4 z-[110] bg-slate-100 w-10 h-10 rounded-full flex items-center justify-center font-bold text-slate-500">‚úï</button>

            <!-- Media Section -->
            <div class="w-full md:w-1/2 p-4 md:p-12 flex flex-col items-center justify-center bg-white border-b md:border-b-0 md:border-r border-slate-50 shrink-0">
                <div id="modal-image-container" class="h-32 md:h-96 flex items-center justify-center w-full transition-all duration-300"></div>
                <h3 id="modal-phone-name" class="mt-2 md:mt-12 text-lg md:text-3xl font-black text-center tracking-tighter uppercase italic"></h3>
            </div>

            <!-- Form Section -->
            <div class="w-full md:w-1/2 p-6 md:p-10 overflow-y-auto bg-white flex-1">
                <div class="mb-5">
                    <p class="text-[9px] font-black uppercase text-slate-400 mb-3 tracking-widest">01. Color</p>
                    <div id="modal-color-picker" class="flex flex-wrap gap-3"></div>
                </div>

                <div class="mb-5">
                    <p class="text-[9px] font-black uppercase text-slate-400 mb-3 tracking-widest">02. Capacity</p>
                    <div id="modal-storage-picker" class="grid grid-cols-3 gap-2"></div>
                </div>

                <div class="space-y-3 mb-6">
                    <p class="text-[9px] font-black uppercase text-slate-400 tracking-widest">03. Shipping</p>
                    <input id="user-name" type="text" placeholder="Your Name" class="w-full border-2 border-slate-100 rounded-xl px-4 py-3 outline-none focus:theme-border text-sm">
                    <input id="user-address" type="text" placeholder="Shipping Address" class="w-full border-2 border-slate-100 rounded-xl px-4 py-3 outline-none focus:theme-border text-sm">
                </div>

                <button onclick="placeOrder()" class="w-full theme-bg text-white py-4 md:py-6 rounded-2xl font-black text-lg md:text-2xl shadow-xl active:scale-95 transition-all">
                    GET MY PHONE
                </button>
            </div>
        </div>
    </div>

    <!-- SETTINGS MENU -->
    <div id="settings-menu" class="fixed right-0 top-0 h-full w-72 bg-white z-[120] shadow-2xl p-8 border-l-8 theme-border">
        <div class="flex justify-between items-center mb-10">
            <h3 class="text-xl font-black uppercase italic theme-text">Theme</h3>
            <button onclick="toggleSettings()" class="text-3xl leading-none">&times;</button>
        </div>
        <div class="grid grid-cols-4 gap-4">
            <div onclick="changeTheme('#ef4444')" class="w-10 h-10 rounded-xl bg-red-500 cursor-pointer"></div>
            <div onclick="changeTheme('#3b82f6')" class="w-10 h-10 rounded-xl bg-blue-500 cursor-pointer"></div>
            <div onclick="changeTheme('#10b981')" class="w-10 h-10 rounded-xl bg-emerald-500 cursor-pointer"></div>
            <div onclick="changeTheme('#000000')" class="w-10 h-10 rounded-xl bg-black cursor-pointer"></div>
            <div onclick="changeTheme('#ec4899')" class="w-10 h-10 rounded-xl bg-pink-500 cursor-pointer"></div>
            <div onclick="changeTheme('#8b5cf6')" class="w-10 h-10 rounded-xl bg-violet-500 cursor-pointer"></div>
        </div>
    </div>

    <button onclick="toggleSettings()" class="fixed bottom-4 right-4 z-[115] w-12 h-12 theme-bg text-white rounded-full flex items-center justify-center shadow-lg">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4" /></svg>
    </button>

    <script>
        const brands = [
            { id: 'apple', name: 'Apple', logo: 'Ô£ø', img: 'https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg' },
            { id: 'samsung', name: 'Samsung', logo: 'S', img: 'https://static.vecteezy.com/system/resources/previews/020/975/547/non_2x/samsung-logo-samsung-icon-transparent-free-png.png' },
            { id: 'google', name: 'Google', logo: 'G', img: 'https://upload.wikimedia.org/wikipedia/commons/c/c1/Google_%22G%22_logo.svg' },
            { id: 'xiaomi', name: 'Xiaomi', logo: 'Mi', img: 'https://upload.wikimedia.org/wikipedia/commons/a/ae/Xiaomi_logo_%282021-%29.svg' },
            { id: 'poco', name: 'Poco', logo: 'P', img: 'https://1000logos.net/wp-content/uploads/2022/12/POCO-Emblem.png' }
        ];

        const phones = [
            { 
                id: 1, 
                name: 'iPhone 17 Pro Max', 
                storage: ['256 GB', '512 GB', '1 TB'],
                variants: [
                    { color: '#f97316', img: 'https://content2.rozetka.com.ua/goods/images/big/594364394.jpg' }, 
                    { color: '#334155', img: 'https://content2.rozetka.com.ua/goods/images/big/594372256.jpg' },
                    { color: '#e2e8f0', img: 'https://content2.rozetka.com.ua/goods/images/big/594352221.jpg' }
                ]
            },
            { 
                id: 2, 
                name: 'iPhone 17 Pro', 
                storage: ['128 GB', '256 GB', '512 GB', '1 TB'],
                variants: [
                    { color: '#f97316', img: 'https://content2.rozetka.com.ua/goods/images/big/594364394.jpg' }, 
                    { color: '#334155', img: 'https://content2.rozetka.com.ua/goods/images/big/594372256.jpg' },
                    { color: '#e2e8f0', img: 'https://content2.rozetka.com.ua/goods/images/big/594352221.jpg' }
                ]
            },
            { 
                id: 3, 
                name: 'iPhone 17', 
                storage: ['128 GB', '256 GB', '512 GB'],
                variants: [
                    { color: '#1c1c1c', name: 'Black', img: 'https://content1.rozetka.com.ua/goods/images/big/594345313.jpg' }, 
                    { color: '#d8d2e1', name: 'Lavender', img: 'https://content1.rozetka.com.ua/goods/images/big/594345455.jpg' }, 
                    { color: '#b6c5d1', name: 'Mist Blue', img: 'https://content.rozetka.com.ua/goods/images/big/594345406.jpg' },
                    { color: '#f9f9f9', name: 'White', img: 'https://content2.rozetka.com.ua/goods/images/big/594345480.jpg' }
                ]
            },
            { 
                id: 4, 
                name: 'iPhone 16 Pro Max', 
                storage: ['256 GB', '512 GB', '1 TB'],
                variants: [
                    { color: '#baafa1', name: 'Desert', img: 'https://content.rozetka.com.ua/goods/images/big/635464828.jpg' },
                    { color: '#b0aea9', name: 'Natural', img: 'https://content1.rozetka.com.ua/goods/images/big/642289153.jpg' },
                    { color: '#3c3c3d', name: 'Black', img: 'https://content.rozetka.com.ua/goods/images/big/635448221.jpg' }
                ]
            },
            { 
                id: 5, 
                name: 'iPhone 15', 
                storage: ['128 GB', '256 GB', '512 GB'], 
                variants: [
                    { color: '#eecad1', name: 'Pink', img: 'https://content2.rozetka.com.ua/goods/images/big/364623524.jpg' }, 
                    { color: '#cadfc1', name: 'Green', img: 'https://content.rozetka.com.ua/goods/images/big/364623606.jpg' }, 
                    { color: '#3c3c3d', name: 'Black', img: 'https://content1.rozetka.com.ua/goods/images/big/364623614.jpg' }
                ] 
            }
        ];

        let currentIdx = 0;
        let startX = 0;
        let isDragging = false;

        window.onload = () => { renderBrands(); setupInputEvents(); };

        function renderBrands() {
            const container = document.getElementById('brand-slider-container');
            container.innerHTML = brands.map((b, i) => `
                <div class="brand-card" id="brand-${i}" onclick="handleBrandClick(${i})">
                    ${b.img ? `<img src="${b.img}" class="brand-logo-img" alt="${b.name}">` : `<span class="text-6xl font-black mb-4">${b.logo}</span>`}
                    <span class="text-xl font-black uppercase tracking-widest mt-4 text-slate-800 text-center">${b.name}</span>
                </div>
            `).join('');
            updateSlider();
        }

        function handleBrandClick(i) {
            if (isDragging) return;
            if (i === currentIdx) selectBrand();
            else { currentIdx = i; updateSlider(); }
        }

        function updateSlider() {
            brands.forEach((_, i) => {
                const card = document.getElementById(`brand-${i}`);
                if (!card) return;
                card.className = 'brand-card';
                if (i === currentIdx) card.classList.add('active');
                else if (i === (currentIdx - 1 + brands.length) % brands.length) card.classList.add('prev');
                else if (i === (currentIdx + 1) % brands.length) card.classList.add('next');
                else if (i < currentIdx) card.classList.add('hidden-left');
                else card.classList.add('hidden-right');
            });
        }

        function moveBrand(dir) { currentIdx = (currentIdx + dir + brands.length) % brands.length; updateSlider(); }

        function setupInputEvents() {
            const slider = document.getElementById('brand-slider-container');
            slider.addEventListener('touchstart', (e) => { startX = e.touches[0].clientX; isDragging = false; }, {passive: true});
            slider.addEventListener('touchend', (e) => {
                const diff = startX - e.changedTouches[0].clientX;
                if (Math.abs(diff) > 40) { isDragging = true; moveBrand(diff > 0 ? 1 : -1); }
            }, {passive: true});
        }

        function selectBrand() {
            document.getElementById('brand-selection').classList.add('hidden');
            document.getElementById('phone-catalog').classList.remove('hidden');
            document.getElementById('header-title').innerText = "Pick Model";
            renderPhones();
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        function renderPhones() {
            const grid = document.querySelector('#phone-catalog > div');
            grid.innerHTML = phones.map(p => `
                <div onclick="openModal(${p.id})" class="bg-white rounded-[2rem] p-6 shadow-sm border border-slate-50">
                    <div class="aspect-[3/4] flex items-center justify-center mb-6 bg-white rounded-2xl border border-slate-50 p-2">
                        <img src="${p.variants[0].img || ''}" class="phone-display-img">
                    </div>
                    <h4 class="text-lg font-black text-center text-slate-800 italic uppercase">${p.name}</h4>
                </div>
            `).join('');
        }

        function openModal(id) {
            const p = phones.find(x => x.id === id);
            document.getElementById('modal-phone-name').innerText = p.name;
            updateModalMedia(p.variants[0]);
            
            document.getElementById('modal-color-picker').innerHTML = p.variants.map(v => `
                <div onclick="updateModalMedia({color: '${v.color}', img: '${v.img}'}, event)" 
                     class="w-10 h-10 rounded-full border-4 border-transparent shadow-md" 
                     style="background-color: ${v.color}"></div>`).join('');
            
            document.getElementById('modal-storage-picker').innerHTML = p.storage.map((size, idx) => `
                <button onclick="handleStorageSelection('${size}', event)" 
                        class="storage-btn border-2 ${idx === 0 ? 'theme-border theme-text active' : 'border-slate-100 text-slate-400'} rounded-xl py-2 font-bold text-xs">${size}</button>`).join('');
            
            document.getElementById('order-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function handleStorageSelection(size, event) {
            document.querySelectorAll('.storage-btn').forEach(btn => {
                btn.classList.remove('active', 'theme-border', 'theme-text');
                btn.classList.add('border-slate-100', 'text-slate-400');
            });
            event.target.classList.add('active', 'theme-border', 'theme-text');
        }

        function updateModalMedia(variant, event) {
            const container = document.getElementById('modal-image-container');
            container.style.opacity = '0';
            setTimeout(() => {
                container.innerHTML = `<img src="${variant.img}" class="phone-display-img">`;
                container.style.opacity = '1';
            }, 200);
            if (event) {
                document.querySelectorAll('#modal-color-picker div').forEach(d => d.style.borderColor = 'transparent');
                event.target.style.borderColor = 'rgba(0,0,0,0.1)';
            }
        }

        function closeModal() { document.getElementById('order-modal').classList.add('hidden'); document.body.style.overflow = 'auto'; }

        function placeOrder() {
            if(!document.getElementById('user-name').value || !document.getElementById('user-address').value) return;
            closeModal();
            document.getElementById('phone-catalog').classList.add('hidden');
            document.getElementById('main-header').classList.add('hidden');
            document.getElementById('order-success').classList.remove('hidden');
            document.getElementById('delivery-path').classList.add('animate-path');
            document.getElementById('courier-van').classList.add('van-on-path');
        }

        function resetApp() { location.reload(); }
        function toggleSettings() { document.getElementById('settings-menu').classList.toggle('open'); }
        function changeTheme(c) {
            document.documentElement.style.setProperty('--primary-color', c);
            renderPhones();
        }
    </script>
</body>
</html>
